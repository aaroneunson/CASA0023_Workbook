<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>CASA0023_Workbook - 5&nbsp; Intro to Google Earth Engine</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Week7.html" rel="next">
<link href="./Week4.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Week6.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Intro to Google Earth Engine</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">CASA0023_Workbook</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Week 1 - Getting Started With Remote Sensing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Using Xaringnan</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Corrections and Enahancements</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Policy</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week6.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Intro to Google Earth Engine</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Classification I</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Classification II</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">SAR</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#summary" id="toc-summary" class="nav-link active" data-scroll-target="#summary"><span class="header-section-number">5.1</span> Summary</a>
  <ul class="collapse">
  <li><a href="#the-setup-of-gee" id="toc-the-setup-of-gee" class="nav-link" data-scroll-target="#the-setup-of-gee"><span class="header-section-number">5.1.1</span> The Setup of GEE</a></li>
  <li><a href="#gee-in-action" id="toc-gee-in-action" class="nav-link" data-scroll-target="#gee-in-action"><span class="header-section-number">5.1.2</span> GEE in Action</a></li>
  </ul></li>
  <li><a href="#application" id="toc-application" class="nav-link" data-scroll-target="#application"><span class="header-section-number">5.2</span> Application</a>
  <ul class="collapse">
  <li><a href="#environmental-monitoring-and-conservation" id="toc-environmental-monitoring-and-conservation" class="nav-link" data-scroll-target="#environmental-monitoring-and-conservation"><span class="header-section-number">5.2.1</span> <strong>Environmental Monitoring and Conservation</strong></a></li>
  <li><a href="#climate-change-and-carbon-sequestration-studies" id="toc-climate-change-and-carbon-sequestration-studies" class="nav-link" data-scroll-target="#climate-change-and-carbon-sequestration-studies"><span class="header-section-number">5.2.2</span> <strong>Climate Change and Carbon Sequestration Studies</strong></a></li>
  <li><a href="#agricultural-practices-and-sustainability" id="toc-agricultural-practices-and-sustainability" class="nav-link" data-scroll-target="#agricultural-practices-and-sustainability"><span class="header-section-number">5.2.3</span> <strong>Agricultural Practices and Sustainability</strong></a></li>
  </ul></li>
  <li><a href="#reflection" id="toc-reflection" class="nav-link" data-scroll-target="#reflection"><span class="header-section-number">5.3</span> Reflection</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Intro to Google Earth Engine</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="summary" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="summary"><span class="header-section-number">5.1</span> Summary</h2>
<section id="the-setup-of-gee" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="the-setup-of-gee"><span class="header-section-number">5.1.1</span> The Setup of GEE</h3>
<p>Google Earth Engine (GEE) is a geospatial processing service that allows for analysis at a large scale, leveraging massive datasets for planetary-scale analysis quickly. It operates by storing data on servers and executing user-written code on this data.</p>
<p><u><strong>GEE Terminology:</strong></u></p>
<ul>
<li><p><strong>Image:</strong> Represents raster data and contains bands.</p></li>
<li><p><strong>Feature:</strong> Represents vector data and contains geometry and attributes.</p></li>
<li><p><strong>ImageCollection:</strong> A stack of images.</p></li>
<li><p><strong>FeatureCollection:</strong> A collection of multiple polygons or vector data.</p></li>
</ul>
<p>GEE uses JavaScript for coding, introducing specific syntax for variables and objects.</p>
<p><strong>Client vs.&nbsp;Server Side:</strong> Code runs either in the browser (client-side) or on the server where data is stored. Objects prefixed with ee are server-side and considered “proxy objects.”</p>
<p><strong>Scale and Projections:</strong></p>
<p>Scale refers to the resolution of images and is determined by the output in GEE, with automatic resampling as needed.</p>
<p>Projections are managed automatically by GEE, typically converting data into the Mercator projection for display.</p>
</section>
<section id="gee-in-action" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="gee-in-action"><span class="header-section-number">5.1.2</span> GEE in Action</h3>
<p><strong>Building Blocks of GEE:</strong> Objects can be vectors, rasters, features, strings, or numbers, each belonging to a specific class with unique GEE functions.</p>
<p><strong>Image Collections:</strong> These are managed by filtering based on dates and regions to handle vast amounts of raster data.</p>
<p><strong>Geometries and Features:</strong> Geometries are points, lines, or polygons without attributes, whereas features include attributes.</p>
<p><strong>Common GEE Processes:</strong> Include geometry operations, joins, zonal statistics, filtering, and various machine learning methods.</p>
<p><strong>Reducing Images:</strong> This involves summarizing image collections to specific values per pixel or region, such as calculating median values or average reflectance within a study area.</p>
<p><strong>Regression Analysis:</strong> GEE supports linear regression over time to analyze changes in pixel values, utilizing a least squares approach and potentially multiple dependent variables.</p>
<p><strong>Joins:</strong> Similar to database joins, allowing for the combination of image or feature collections based on specific criteria.</p>
</section>
</section>
<section id="application" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="application"><span class="header-section-number">5.2</span> Application</h2>
<p><br>
The introduction of Google Earth Engine has transformed the ways in which geospatial data is and can be analysed and applied. Due to its easy access to data (with over <a href="https://www.earthblox.io/blog/google-earth-engine-for-commercial-use-what-the-new-access-means-for-your-impact-business">50Pb of data in its catalogue</a>!), processing capabilities, as well as its commercial accessibility, GGE has significant applications in environmental and climate change science, urban planning, agriculture, and disaster management, among many other uses.</p>
<p>In <a href="https://blog.google/products/earth/introducing-earth-engine-for-governments-and-businesses/">2022, Google made it possible</a> to buy commercial licenses for the use of the platform, before this it was restricted (formally) for use in research, education, or not-for-profit activities.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src=".\Week6/remotesensing-13-03778-g001.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Google Earth Engine Scholarly Use Over Time (<a href="https://www.mdpi.com/2072-4292/13/18/3778">Zhao et al, 2021</a>)</figcaption>
</figure>
</div>
<section id="environmental-monitoring-and-conservation" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="environmental-monitoring-and-conservation"><span class="header-section-number">5.2.1</span> <strong>Environmental Monitoring and Conservation</strong></h3>
<p>One of the most significant applications of GEE is in environmental monitoring and conservation. Because of the platform’s ability to handle massive datasets and perform planetary-scale analyses has been pivotal in tracking deforestation and forest fires, mapping biodiversity, and monitoring water resources. A study by <a href="https://www.science.org/doi/10.1126/science.1244693">Hansen et al.&nbsp;(2013)</a> utilised GEE to map global forest cover and loss, providing insights into deforestation trends that inform conservation policies. They produced high-resolution global maps of 21st-century forest cover change. The study used GEE’s ability to handle large-scale image collections and its efficient processing capabilities (which run on powerful remote servers) to analyse satellite imagery over time, illustrating the platform’s power in environmental governance and policy-making. This ability to more easily understand, map, and quantify the world.</p>
<p><img src=".\Week6/hansen_etal_2013.jpg" class="img-fluid" alt="(A) Tree cover, (B) forest loss, and (C) forest gain. A color composite of tree cover in green, forest loss in red, forest gain in blue, and forest loss and gain in magenta is shown in (D), with loss and gain enhanced for improved visualization (Hansen et al, 2013)">.</p>
</section>
<section id="climate-change-and-carbon-sequestration-studies" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="climate-change-and-carbon-sequestration-studies"><span class="header-section-number">5.2.2</span> <strong>Climate Change and Carbon Sequestration Studies</strong></h3>
<p>GEE has also been instrumental in climate change research, particularly in assessing carbon stocks and fluxes. The platform’s ability to process and analyze vast amounts of raster data enables researchers to estimate carbon sequestration and emission levels across large areas. For example, Gorelick et al.&nbsp;(2017) highlighted the use of GEE in quantifying changes in forest carbon stocks, employing the platform’s image collection and reduction capabilities to assess temporal changes in biomass. Such studies are crucial for understanding the carbon cycle and informing international climate agreements like the Paris Agreement.</p>
</section>
<section id="agricultural-practices-and-sustainability" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="agricultural-practices-and-sustainability"><span class="header-section-number">5.2.3</span> <strong>Agricultural Practices and Sustainability</strong></h3>
<p>Some companies, such as <a href="https://www.regrow.ag/case-studies">Regrow</a>, are using GEE to report and verify regenerative and sustainable agricultural techniques. Through GEE’s analysis of historical and satellite imagery, Regrow is able to generate detailed data on farmland, enhancing the ability to monitor and improve sustainable practices on a large scale.</p>
<p>Regrow has collaborated with General Mills to track the adoption of regenerative agriculture practices across 175 million acres of agricultural land, globally. This effort involves using remote sensing technology and modeling (employing GEE) to monitor and verify regenerative techniques. The partnership is aiming to enhance resilience in General Mills’ supply chain by making well-informed decisions about investing in regenerative programs, with the aim of reducing greenhouse gas emissions by 30% by 2030 (although, in my personal view, this 30% target does not seem particularly revolutionary or impressive; the <a href="https://www.gov.uk/government/news/pm-recommits-uk-to-net-zero-by-2050-and-pledges-a-fairer-path-to-achieving-target-to-ease-the-financial-burden-on-british-families">UK government</a> has set its target at 68%, though the baseline level for each may vary).</p>
<p>Regrow and General Mills utilised the <a href="https://www.ctic.org/OpTIS_Information">Operational Tillage Information System (OpTIS)</a> and <a href="https://www.ipbes.net/policy-support/tools-instruments/dndc-denitrification-decomposition">DeNitrification-DeComposition (DNDC)</a> models for their project. OpTIS leverages satellite imagery to monitor and verify regenerative agriculture techniques, including tillage reduction and cover-crop adoption. The data from OpTIS feeds into the DNDC model, which simulates nutrient cycling in soil to predict crop growth, soil temperature and moisture, carbon dynamics, nitrogen leaching, and trace gases emissions and thus estimate net changes in greenhouse gas emissions.</p>
</section>
</section>
<section id="reflection" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="reflection"><span class="header-section-number">5.3</span> Reflection</h2>
<p>Google Earth Engine certainly makes using RS data easier to manage. Its speed is incomparable with SNAP - where SNAP is walking, GEE is whizzing around the planet at the speed of the satellites themselves it would seem!</p>
<p>Whilst GEE is largely easy to use, it does come with the caveat of learning another coding language. As it is based on JavaScript, however, this does not seem too bad and shares many similarities with other languages I have learned, also the actual amount of JavaScript knowledge that is required is relatively little.</p>
<p>What has really surprised me is the immense uptake of GEE use within publications - annoyingly I can’t seem to find the exact time-series plot I seem to remember us seeing in the lecture (of GEE use in RS publications compared with other languages uses), but the one I have shown for this week’s entry still demonstrates the point - it has received exponentially increasing uptake, which is only likely to increase as more people become familiar with it.</p>
<p>It also surprised me that GEE only became available for commercial use in 2022 - given its immense capabilities, it seems (from a profit point of view) crazy for Google not to be licensing out the software’s use. Although, I would assume perhaps Google was anxious of too significant interest that its servers (renown for their speed, compared to local computational capacity) would become overwhelmed.</p>
<p>On the note of profitability, whilst its uptake is massively impressive, it does raise concerns (at least in my mind) of monopolisation - if Google come to dominate the RS space and industry there are no doubt consequences of this. They have demonstrated themselves to deliver high-quality and have an exceptionally well regarded reputation. However, <a href="https://www.cogitatiopress.com/urbanplanning/article/view/2519">Carr and Hesse (2020)</a> demonstrated the implications of Alphabet Inc.’s (Google’s parent company) involvement in a ‘smart city’ development in Toronto, Canada. They behaves in a hegemonic, monopolisitc way, disregarding local issues and complaints. Whilst that was within the realm of urban planning and urban development, it is still concerning.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Week4.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Policy</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Week7.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Classification I</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>